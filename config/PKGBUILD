# Maintainer Chris Werner Rau <aur@cwrau.io>

tar -h --exclude=.idea -cf rootfs.tar -C rootfs .

pkgname=linux-config
pkgver=0.1.0
pkgrel=17
pkgdesc='linux config'
url="https://github.com/cwrau/linux-config"
license=('GPL3')
arch=('x86_64')
source=('rootfs.tar')
noextract=('rootfs.tar')
sha512sums=('SKIP')
depends=(
  advcpmv
  alvr
  ansible
  archiso-systemd-boot
  aria2
  ausweisapp2
  autorandr
  bandwhich
  base
  base-devel
  bash-completion
  bash-git-prompt
  bat
  bat-extras
  batsignal
  bc
  bemoji
  bind
  blueman
  bluez-utils
  bottles
  breeze-hacked-cursor-theme-git
  btrfs-progs
  calf
  chafa
  chart-testing
  clipmenu
  cloudflared
  clusterctl
  cocogitto
  curl
  ddcutil
  devtools
  diff-so-fancy
  direnv
  discord
  discover-overlay
  dive
  dnsmasq
  dolphin-emu
  dua-cli
  duf
  dunst
  dyff
  earlyoom
  easyeffects
  edk2-ovmf
  efibootmgr
  fd
  feh
  flameshot
  fluxcd
  fprintd
  freerdp
  freetype2
  fwupd
  fzf
  fzf-tab-git
  gamemode
  gamescope
  gfeeds
  ghostty
  git
  git-delete-merged-branches
  git-delta
  git-secret
  github-cli
  glab
  glava
  gnome-keyring
  gnome-terminal
  gnu-netcat
  gnupg
  go
  go-task
  gomplate
  google-chrome
  gopass
  gopass-fuse
  gradle
  grml-full-systemd-boot
  gum
  gvfs
  helm
  helm-diff
  helm-docs
  helmrelease-tools
  hexchat
  hsetroot
  hwatch
  i3-wm
  i3lock-color
  ibus
  informant
  inotify-tools
  intellij-idea-ultimate-edition
  intellij-idea-ultimate-edition-jre
  jdk-openjdk
  joystickwake
  jq
  k9s
  k9s-capi
  k9s-flux
  k9s-openstack
  kdeconnect
  kernel-modules-hook
  kitty
  ksops-bin
  kube-bench-bin
  kube-score
  kubeconform
  kubectl
  kubectl-explore
  kubelogin
  lazygit
  less
  libgnome-keyring
  libinput-gestures
  libva-mesa-driver
  linux-firmware
  'linux-lts<6.15' # otherwise nvidia-550xx-dkms fails to build
  linux-lts-headers
  linux-zen
  linux-zen-headers
  lnav
  lscolors-git
  lsd
  lsp-plugins
  luarocks
  man-db
  man-pages
  masterpdfeditor-free
  matcha-gtk-theme
  mesa
  minq-ananicy-git
  mitmproxy
  moreutils
  morsetran
  mpv
  mpv-mpris
  mtr
  neovim
  neovim-symlinks
  net-tools
  networkmanager-dmenu
  nodejs-neovim
  notify-send.sh
  noto-fonts-cjk
  noto-fonts-emoji
  noto-fonts-extra
  nss-mdns
  nvim-ft-pkgbuild
  nvtop
  obs-studio
  ocl-icd
  oh-my-zsh-git
  openssh
  pacman-contrib
  pacman-hook-systemd-preset
  papirus-icon-theme
  paru
  paruz
  pavucontrol
  perl-anyevent-i3
  perl-file-mimeinfo
  picom
  pipewire-pulse
  pkgstats
  playerctl
  podman
  polkit
  polkit-gnome
  polybar
  polybar-scripts-git
  powertop
  prettyping
  prismlauncher-qt5-bin
  procs
  proton-ge-custom-bin
  pv
  python-dynmen
  python-notify2
  python-pip
  python-pre-commit
  python-pulsectl
  python-pynvim
  python-rope
  python-traitlets
  python-virtualenv
  qtqr
  r-quick-share
  rebuild-detector
  reflector
  ripgrep
  rocketchat-desktop
  rofi
  rofi-calc
  rofi-dmenu
  rofi-randr
  siji-git
  slit-git
  slurp
  snap-pac
  socat
  sof-firmware
  sops
  sshpass
  sshuttle
  steam-native-runtime
  suyu-bin
  sxiv
  systemd
  systemd-boot-pacman-hook
  systemd-resolvconf
  sysz
  tailscale
  telegram-desktop
  telepresence2-bin
  tmux
  tree
  ttf-dejavu
  ttf-firacode-nerd
  ttf-font-awesome
  ttf-iosevka-nerd
  ttf-liberation
  ttyplot
  tuxedo-control-center-bin
  udiskie-dmenu-git
  uhk-agent-appimage
  unclutter
  unzip
  up
  usbutils
  v4l2loopback-dkms
  which
  wireguard-tools
  xarchiver
  xclip
  xdg-desktop-portal-gtk
  xh
  xorg-server
  xorg-xev
  xorg-xinit
  xorg-xinput
  xorg-xkill
  xorg-xprop
  xorg-xwininfo
  xss-lock-session
  yamllint
  yq
  ytmdesktop-bin
  zip
  zsh
  zsh-autosuggestions
  zsh-completions
  zsh-syntax-highlighting
  zsh-theme-powerlevel10k
  zsh-you-should-use
)

if grep -iq AMD /proc/cpuinfo; then
  depends+=(amd-ucode)
else
  depends+=(intel-ucode)
fi

if lspci | grep ' VGA ' | grep -q -i nvidia; then
  case 5 in
    n)
      depends+=(
        nvidia-dkms
        opencl-nvidia
        lib32-opencl-nvidia
        nvidia-utils
        lib32-nvidia-utils
      )
      ;;
    5)
      depends+=(
        nvidia-550xx-dkms
        opencl-nvidia-550xx
        lib32-opencl-nvidia-550xx
        nvidia-550xx-utils
        lib32-nvidia-550xx-utils
      )
      ;;
    o)
      depends+=(
        nvidia-open-dkms
        opencl-nvidia
        lib32-opencl-nvidia
        nvidia-utils
        lib32-nvidia-utils
      )
    ;;
  esac
fi

package() {
  tar -xf rootfs.tar -C "$pkgdir"
}
